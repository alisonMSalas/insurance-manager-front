<div class="content-area">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <!-- Encabezado -->
  <div class="insurance-header">
    <div>
      <h2 class="section-title">Todos los Seguros</h2>
      <p class="section-subtitle">Gestiona y revisa el estado de los seguros</p>
    </div>
    <p-button
      icon="pi pi-plus"
      label="Nuevo Seguro"
      styleClass="p-button-primary"
    ></p-button>
  </div>

  <!-- Filtros -->
  <div class="filters-container">
    <div class="filter-group">
      <label for="statusFilter">Estado:</label>
      <p-select
        [options]="statusOptions"
        [(ngModel)]="selectedStatus"
        optionLabel="label"
        optionValue="value"
        (ngModelChange)="applyFilters()"
        [showClear]="true"
        placeholder="Todos"
        class="w-full md:w-56"
      >
      </p-select>
    </div>

    <div class="filter-group">
      <label for="typeFilter">Tipo:</label>
      <p-select
        [options]="typeOptionsWithAll"
        [(ngModel)]="selectedType"
        optionLabel="label"
        optionValue="value"
        (ngModelChange)="applyFilters()"
        [showClear]="true"
        placeholder="Todos"
        class="w-full md:w-56"
      >
      </p-select>
    </div>

    <div class="filter-group">
      <label>&nbsp;</label>
      <p-button
        icon="pi pi-refresh"
        (onClick)="refreshData()"
        [loading]="loading"
        styleClass="p-button-text"
        [pTooltip]="'Actualizar datos'"
        tooltipPosition="bottom"
      ></p-button>
    </div>
  </div>

  <!-- Grid de tarjetas -->
  <div class="insurance-grid">
    <p-card *ngFor="let insurance of filteredInsurances" class="insurance-card">
      <div class="insurance-header">
        <h3 class="insurance-title">{{ insurance.name }}</h3>
        <span
          [ngClass]="{
            'insurance-status': true,
            'status-active': insurance.active,
            'status-inactive': !insurance.active
          }"
        >
          <span class="status-badge"></span>
          {{ insurance.active ? "Activo" : "Inactivo" }}
        </span>
      </div>
      <span class="insurance-type">{{
        getInsuranceTypeLabel(insurance.type)
      }}</span>
      <div class="insurance-details">
        <p>Cobertura: {{ insurance.coverage | currency }}</p>
        <p>Deducible: {{ insurance.deductible | currency }}</p>
        <p>
          Pago: {{ insurance.paymentAmount | currency }}
          {{ getPaymentPeriodLabel(insurance.paymentPeriod) }}
        </p>
      </div>

      <div class="insurance-actions">
        <p-button
          [icon]="insurance.active ? 'pi pi-arrow-down' : 'pi pi-arrow-up'"
          [label]="insurance.active ? 'Inactivar' : 'Activar'"
          size="small"
          (onClick)="changeStatus(insurance)"
          styleClass="p-button-text p-button-plain action-btn view"
        ></p-button>
        <p-button
          icon="pi pi-eye"
          label="Ver"
          size="small"
          styleClass="p-button-text p-button-plain action-btn view"
        ></p-button>
        <p-button
          icon="pi pi-pencil"
          label="Editar"
          size="small"
          styleClass="p-button-text p-button-plain action-btn edit"
        ></p-button>
        <p-button
          icon="pi pi-trash"
          label="Eliminar"
          size="small"
          (onClick)="deleteInsurance(insurance)"
          styleClass="p-button-text p-button-plain action-btn delete"
        ></p-button>
      </div>
    </p-card>
  </div>
</div>
