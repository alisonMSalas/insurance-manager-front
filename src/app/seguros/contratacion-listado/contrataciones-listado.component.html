<p-toast></p-toast>
<div class="content-area">
  <div class="insurance-header">
    <div>
      <div class="text-2xl text-white">Contrataciones</div>
    </div>
  </div>

  <p-divider></p-divider>

  <div class="content-container">

    <div class="actions" *ngIf="canCreateContract()">
      <button pButton label="Nueva Contratación" icon="pi pi-plus" [routerLink]="['/contratacion']"
        class="p-button-primary"></button>
    </div>
    <p-table [value]="contratos" [paginator]="true" [rows]="10" [responsiveLayout]="'scroll'">
      <ng-template pTemplate="header">
        <tr>
          <th>Cliente</th>
          <th>Nombre del Seguro</th>
          <th>Fecha de Inicio</th>
          <th>Estado</th>
          <th>Monto Pagado</th>
          <th>Beneficiarios</th>
          <th *ngIf="canViewContracts()">Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-contrato>
        <tr>
          <td>{{ (contrato.client?.lastName+' ' +contrato.client?.name) || '-' }}</td>
          <td>{{ contrato.insurance?.name || '-' }}</td>
          <td>{{ formatFecha(contrato.startDate) }}</td>
          <td>
            <p-chip [label]="formatStatus(contrato.status)"
              [styleClass]="'status-' + contrato.status?.toLowerCase()"></p-chip>
          </td>

          <td>{{ contrato.totalPaymentAmount !== undefined ? contrato.totalPaymentAmount : '-' }}</td>
          <td>{{ formatBeneficiaries(contrato.beneficiaries) }}</td>
          <td *ngIf="canViewContracts()">
            <button pButton icon="pi pi-folder-open" class="p-button-text p-button-plain p-button-sm"
              [routerLink]="['/main-revision', contrato.id]" title="Revisión de Documentación"></button>

            <button *ngIf="canDeactivateContract()"  pButton icon="pi pi-trash" class="p-button-text p-button-plain p-button-sm"
              (click)="onEliminar(contrato)" title="Eliminar Contrato" style="margin-left: 0.5rem; color: red;">
            </button>

          </td>

        </tr>
      </ng-template>
    </p-table>
  </div>
</div>